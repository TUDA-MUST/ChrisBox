# ChrisBox
(**CH**arge **R**eading **I**nferface **S**ystem Box)\
4-Channel Charge Amplifier PCB

## Introduction

Welcome to ChrisBox!\
ChrisBox is a four-channel charge amplifier, mainly developed for the simultaneous charge measurement of four ferroelectret sensors.
The main goals of the development were
- low noise (shielding concept),
- portability,
- usability,
- affordability.

More details about ChrisBox can be found [here](#about-chrisbox).

> [!IMPORTANT]
> This document describes the features and assembly of ChrisBox and does not provide guidance on constructing or using ferroelectret sensors.

![Rendered image of ChrisBox with display, battery and connected ferroelectret sensors.](/data/ChrisBox_rendering_inscription.png)

## About this Repository

This repository contains the PCB design of ChrisBox, the CAD files for the Box, where the PCB can be combined with a battery and a display, as well as general code for the PCB.
- [PCB](/PCB) -> circuit board
- [CAD](/CAD) -> housing for the circuit board and an additional display
- [CODE](/CODE) -> code to be flashed on the microcontroller of the PCB, and code for a Nextion display.

A code description is found in the `./CODE` folder, if you just want to build a ChrisBox, the following instructions should be sufficient.

Ordering and Building instructions are included here:
- [ORDERING INSTRUCTIONS](/ORDERING_INSTRUCTIONS.md)
- [BUILDING INSTRUCTIONS](/BUILDING_INSTRUCTIONS.md)

Contributing to ChrisBox and this repository: [CONTRIBUTORS](#contributors).\
License: [LICENSE](/LICENSE).

Information about citation is found here: [CITATION](#citation).

## About ChrisBox

### Development objective and target group

Piezoelectric sensors convert electric charge in response to mechanical loading and are widely studied for their high sensitivity.
In particular, ferroelectret sensors provide the flexibility and material system design that enable biocompatibility.
These signals are typically captured using commercial electrometers or custom-built charge amplifiers to enable portability.
However, the latter often lack the precision and robustness against electromagnetic interference (EMI).
Therefore, we present a compact, four-channel portable measurement system specifically designed for charge-based force sensing with piezoelectric sensors, called ChrisBox.
The system has been developed at the **Measurement and Sensor Technology Group** at **Technische Universität Darmstadt**, Darmstadt, Germany.

The main goals of the development were:
- **Low noise:** achieved through a shielding concept that covers the PCB, the cable to the sensor, and, depending on the sensor, the sensor itself.
- **Portability:** a key advantage over traditional electrometers and oscilloscopes, enabling measurements on the human body while walking or performing other movements.
- **Usability:** the PCB is designed for users without expertise in PCB development or programming, allowing straightforward measurements with ferroelectret sensors.
- **Affordability:** one assembled PCB costs roughly 50 euros in 2025, facilitating reproduction and simultaneous use while avoiding the need for expensive laboratory instruments such as electrometers.

### Detailed decription of ChrisBox

**Analog electronics**
A ferroelectret is connected to the PCB via a USB-C cable and connector.
The signal wires, D+ and D-, carry the charge displacement generated by the ferroelectret, which is converted into a voltage signal by a charge amplifier.
An exemplary application of this setup is heart rate measurement, which requires low-frequency measurements.
Therefore, a large feedback resistor (in the G&Omega; range) is used in the charge amplifier.
A reference voltage at the midpoint of the measurement range (around 1.65 V) is provided to enable differential measurements within the 0–3.3 V range.
The analog electronics are replicated four times, with each channel operating independently.

**Digital electronics**
The output of each charge amplifier is connected to an ADC (ADS1220).
The reference voltage is also supplied to the ADC to enable differential measurements.
All four ADCs communicate with an ESP32 via SPI.

**ESP32**
An ESP32 S3 Mini 1 serves as the microcontroller of the ChrisBox, accompanied by Boot and Reset buttons.
A UART-to-USB converter ensures reliable connectivity with various PCs.

**Support circuits**
The PCB includes several additional circuits: four programmable status LEDs controlled by the ESP32, a UART connector for interfacing with a Nextion display, and a connector providing access to five GPIO pins of the ESP32 for custom functions.
A 5 V supply, switchable by the ESP32, can power the Nextion display.
A battery can be connected for power supply and is simultaneously charged when the board is connected to USB.

**Shielding**
The PCB is shielded by a metallic frame and cover, as well as an internal shielding layer within the board.
USB-C cables are used to connect the ferroelectret sensors, as they are both shielded and readily available.
Each ferroelectret sensor must be soldered to a USB-C connector.
Since an unshielded ferroelectret sensor can act as a source of noise, proper shielding is essential to ensure a low-noise measurement setup.

**Data output**
The acquired measurement data can be output in several ways:
- Serial communication to a PC,
- UART connection to a Nextion display for real-time visualization,
- ESP-NOW for wireless data transmission, requiring a second ESP32 as receiver for the data, which itself could communicate to a PC.

## Contributors

ChrisBox was developed at the [Measurement and Sensor Technology Group](https://www.etit.tu-darmstadt.de/must/) at Technische Universität Darmstadt, Germany, by:
- [Sven Suppelt](https://orcid.org/0000-0002-2338-9333)
- [Dominik Werner](https://orcid.org/0009-0001-8082-5584)
- [Alexander A. Altmann](https://orcid.org/0000-0001-5299-3620)
- [Felix Herbst](https://orcid.org/0000-0003-1480-3691)
- [Jan H. Dörsam](https://orcid.org/0000-0001-9807-6641)
- [Bastian Latsch](https://orcid.org/0000-0001-9929-5694)
- [Prof. Mario Kupnik](https://orcid.org/0000-0003-2287-4481)

## Citation

If you would like to reference the project, please cite the following (yet to publish...) [paper](https://www.etit.tu-darmstadt.de/must/):

```
@article{name2025,
  author={},
  booktitle={},
  title={},
  year={2025},
  pages={},
  doi={}
```
